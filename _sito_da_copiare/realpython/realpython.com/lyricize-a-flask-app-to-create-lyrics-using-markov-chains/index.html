
<!doctype html>
<html lang="en">
<head>
<link href="https://cdn.realpython.com" rel="preconnect">
<link href="https://files.realpython.com" rel="preconnect">
<title>Lyricize: A Flask app to create lyrics using Markov chains – Real Python</title>
<meta name="author" content="Real Python">
<meta name="description" content="In this post, we&#x27;ll work through the process of launching a MVP, from the initial conception of the idea to a shareable prototype utilizing Flask. We&#x27;ll create an app to generate lyrics using Markov chains.">
<meta name="keywords" content="">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">
<link rel="stylesheet" href="https://cdn.realpython.com/static/realpython.min.1ecfd4a9d422.css">
<link rel="stylesheet" href="https://cdn.realpython.com/static/gfonts/font.08e909e5f3d4.css">
<link rel="preload" href="https://cdn.realpython.com/static/glightbox.min.f69035b3cab2.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdn.realpython.com/static/glightbox.min.f69035b3cab2.css"></noscript>
<link rel="canonical" href="https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg">
<meta property="og:image" content="https://cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg">
<meta name="twitter:creator" content="@realpython">
<meta name="twitter:site" content="@realpython">
<meta property="og:title" content="Lyricize: A Flask app to create lyrics using Markov chains – Real Python">
<meta property="og:type" content="article">
<meta property="og:url" content="https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/">
<meta property="og:description" content="In this post, we&#x27;ll work through the process of launching a MVP, from the initial conception of the idea to a shareable prototype utilizing Flask. We&#x27;ll create an app to generate lyrics using Markov chains.">
<link href="https://cdn.realpython.com/static/favicon.68cbf4197b0c.png" rel="icon">
<link href="https://realpython.com/atom.xml" rel="alternate" title="Real Python" type="application/atom+xml">
<link rel="manifest" href="/manifest.json">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-35184939-1', 'auto', {'allowLinker': true});

  
    ga('set', 'anonymizeIp', true);
  

  

  
  
  ga('set', {
    dimension1: false,
    dimension2: false
  });
  

  ga('send', 'pageview');
  
</script>
<script async src='/cdn-cgi/bm/cv/669835187/api.js'></script></head>
<body>
<nav class="navbar fixed-top navbar-expand-lg navbar-dark flex-column ">
<div class="container flex-row">
<a class="navbar-brand" href="/">
<img src="https://cdn.realpython.com/static/real-python-logo.893c30edea53.svg" width="165" height="40" class="d-inline-block align-top" alt="Real Python">
</a>
<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse navbar-nav-scroll" id="navbarSupportedContent" role="navigation" aria-label="Main Navigation">
<ul class="navbar-nav mr-2 flex-fill">
<li class="nav-item">
<a class="nav-link" href="/start-here/">Start&nbsp;Here</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownLibrary" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<span class="fa fa-graduation-cap" aria-hidden="true"></span> Learn Python
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownLibrary">
<a class="dropdown-item" href="/" style="color: #ff7e73; line-height: 110%;"><i class="fa fa-fw mr-1 fa-graduation-cap" aria-hidden="true"></i> Python Tutorials →<br><small class="text-secondary">In-depth articles and tutorials</small></a>
<a class="dropdown-item" href="/courses/" style="color: #abe5b1; line-height: 110%;"><i class="fa fa-fw mr-1 fa-film" aria-hidden="true"></i> Video Courses →<br><small class="text-secondary">Step-by-step video lessons</small></a>
<a class="dropdown-item" href="/quizzes/" style="color: #abe0e5; line-height: 110%;"><i class="fa fa-fw mr-1 fa-trophy" aria-hidden="true"></i> Quizzes →<br><small class="text-secondary">Check your learning progress</small></a>
<a class="dropdown-item" href="/learning-paths/" style="color: #ffc873; line-height: 110%;"><i class="fa fa-fw mr-1 fa-map-o" aria-hidden="true"></i> Learning Paths →<br><small class="text-secondary">Guided study plans for accelerated learning</small></a>
<a class="dropdown-item" href="/community/" style="color: #e5c6ab; line-height: 110%;"><i class="fa fa-fw mr-1 fa-slack" aria-hidden="true"></i> Community →<br><small class="text-secondary">Learn with other Pythonistas</small></a>
<a class="dropdown-item pb-3" href="/tutorials/all/" style="color: #b8abe5; line-height: 110%;"><i class="fa fa-fw mr-1 fa-tags" aria-hidden="true"></i> Topics →<br><small class="text-secondary">Focus on a specific area or skill level</small></a>
<a class="dropdown-item border-top" href="/account/join/"><i class="fa fa-fw fa-star text-warning" aria-hidden="true"></i> Unlock All Content</a>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBooksCourses" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Store
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownBooksCourses">
<a class="dropdown-item" href="/account/join/"><i class="fa fa-fw fa-star text-warning" aria-hidden="true"></i> RP Membership</a>
<a class="dropdown-item" href="/products/python-basics-book/">Python Basics Book</a>
<a class="dropdown-item" href="/products/python-tricks-book/">Python Tricks Book</a>
<a class="dropdown-item" href="/products/cpython-internals-book/">CPython Internals Book</a>
<a class="dropdown-item" href="/products/real-python-course/">The Real Python Course</a>
<a class="dropdown-item" href="/products/managing-python-dependencies/">Managing Python Dependencies</a>
<a class="dropdown-item" href="/products/sublime-python/">Sublime Text + Python Setup</a>
<a class="dropdown-item" href="/products/pythonic-wallpapers/">Pythonic Wallpapers Pack</a>
<a class="dropdown-item" href="https://nerdlettering.com" target="_blank">Python Mugs, T-Shirts, and More</a>
<a class="dropdown-item" href="https://www.pythonistacafe.com" target="_blank">Pythonista Cafe Community</a>
<a class="dropdown-item border-top" href="/products/">Browse All »</a>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMore" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
More
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMore">
<a class="dropdown-item" href="/newsletter/">Python Newsletter</a>
<a class="dropdown-item" href="/podcasts/rpp/">Python Podcast</a>
<a class="dropdown-item" href="https://www.pythonjobshq.com" target="_blank">Python Job Board</a>
<a class="dropdown-item" href="/team/">Meet the Team</a>
<a class="dropdown-item" href="/write-for-us/">Become a Tutorial Author</a>
<a class="dropdown-item" href="/become-an-instructor/">Become a Video Instructor</a>
</div>
</li>
</ul>
<div class="d-block d-xl-none">
<ul class="navbar-nav">
<li class="nav-item">
<a class="nav-link" href="/search" title="Search"><span class="d-block d-lg-none"><i class="fa fa-search" aria-hidden="true"></i> Search</span><span class="d-none d-lg-block"><i class="fa fa-search" aria-hidden="true"></i></span></a>
</li>
</ul>
</div>
<div class="d-none d-xl-flex align-items-center mr-2">
<form class="form-inline" action="/search" method="GET">
<a class="js-search-form-submit position-absolute" href="/search" title="Search"><i class="fa fa-search fa-fw text-muted pl-2" aria-hidden="true"></i></a>
<input class="search-field form-control form-control-md mr-sm-1 mr-lg-2 w-100" style="padding-left: 2rem;" maxlength=50 type="search" placeholder="Search" aria-label="Search" name="q">
<input type="hidden" name="_from" value="nav">
</form>
</div>
<ul class="navbar-nav">
<li class="nav-item form-inline">
<a class="ml-2 ml-lg-0 btn btn-sm btn-primary px-3" href="/account/join/">Join</a>
</li>
<li class="nav-item">
<a class="btn text-light" href="/account/login/?next=%2Flyricize-a-flask-app-to-create-lyrics-using-markov-chains%2F">Sign&#8209;In</a>
</li>
</ul>
</div>
</div>
</nav>
<div class="container main-content">
<div class="row justify-content-center">
<div class="col-md-11 col-lg-8 article with-headerlinks">
<figure class="embed-responsive embed-responsive-16by9">
<img class="card-img-top m-0 p-0 embed-responsive-item rounded" style="object-fit: contain;" alt="Lyricize: A Flask app to create lyrics using Markov chains" src="https://cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg" width="1920" height="1080" srcset="https://robocrop.realpython.net/?url=https%3A//cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg&amp;w=480&amp;sig=c121fbbfdf614cc5ea1272f360dcca37f52a621c 480w, https://robocrop.realpython.net/?url=https%3A//cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg&amp;w=960&amp;sig=5fce0c64e808c601b4f8072c9e56e8c98a8029f0 960w, https://cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg 1920w" sizes="75vw">
</figure>
<h1>Lyricize: A Flask app to create lyrics using Markov chains</h1>
<div class="mb-0">
<span class="text-muted">by <a class="text-muted" href="/">Real Python</a>
<span class="ml-2 mr-1 fa fa-comments"></span><a class="text-muted" href="#reader-comments"><span class="disqus-comment-count" data-disqus-identifier="https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/"></span></a>
<span class="ml-2 fa fa-tags" aria-hidden="true"></span>
<a href="/tutorials/flask/" class="badge badge-light text-muted">flask</a>
<a href="/tutorials/projects/" class="badge badge-light text-muted">projects</a>
<a href="/tutorials/web-dev/" class="badge badge-light text-muted">web-dev</a>
<div class="d-sm-flex flex-row justify-content-between my-3 text-center">
<div class="jsCompletionStatusWidget btn-group mb-0">
<button title="Click to mark as completed" class="jsBtnCompletion btn btn-secondary border-right " style="border-top-right-radius: 0; border-bottom-right-radius: 0;" disabled>Mark as Completed</button>
<button title="Add bookmark" class="jsBtnBookmark btn btn-secondary border-left" disabled><i class="fa fa-fw fa-bookmark-o"></i></button>
</div>
<div class="align-self-center my-2">
<span>
<a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet/?text=Check out this %23Python tutorial: Lyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains by @realpython&url=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-twitter text-light mb-1"><i class="mr-1 fa fa-twitter text-light"></i>Tweet</a>
<a target="_blank" rel="nofollow" href="https://facebook.com/sharer/sharer.php?u=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-facebook text-light mb-1"><i class="mr-1 fa fa-facebook text-light"></i>Share</a>
<a target="_blank" rel="nofollow" href="mailto:?subject=Python article for you&body=Check out this Python tutorial:%0A%0ALyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains%0A%0Ahttps%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="badge badge-red text-light mb-1"><i class="mr-1 fa fa-envelope text-light"></i>Email</a>
</span>
</div>
</div>
</div>
<div class="article-body">
<div class="bg-light sidebar-module sidebar-module-inset" id="toc">
<p class="h3 mb-2 text-muted">Table of Contents</p>
<div class="toc">
<ul>
<li><a href="#from-idea-to-mvp">From Idea to MVP</a></li>
<li><a href="#find-a-topic-of-interest">Find a topic of interest</a></li>
<li><a href="#start-developing">Start Developing</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#next-iteration">Next Iteration</a></li>
<li><a href="#add-flask">Add Flask</a></li>
<li><a href="#deploy-to-heroku">Deploy to Heroku</a></li>
<li><a href="#conclusion-next-steps">Conclusion &amp; Next Steps</a></li>
</ul>
</div>
</div>
<div class="sidebar-module sidebar-module-inset p-0" style="overflow:hidden;">
<div style="display:block;position:relative;">
<div style="display:block;width:100%;padding-top:12.5%;"></div>
<div class="rpad rounded border" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
</div>
<a class="small text-muted" href="/account/join/" rel="nofollow"> <i class="fa fa-info-circle" aria-hidden="true"> </i> Remove ads</a>
</div>
<p>New coders <a href="http://www.reddit.com/r/learnpython/comments/xjlsh/i_just_finished_codeacademys_python_course/">are</a> <a href="http://www.reddit.com/r/learnpython/comments/zc2c2/done_learning_python_what_next/">always</a> <a href="http://www.reddit.com/r/learnpython/comments/ul1b8/any_good_projects_for_beginners/">looking</a> <a href="http://www.reddit.com/r/learnpython/comments/1a9yie/worked_with_python_for_almost_a_year_now_how_to/">for</a> <a href="http://www.reddit.com/r/learnpython/comments/1iqv3c/please_help_me_prepare_a_roadmap_as_to_what_i/">new</a> <a href="http://www.reddit.com/r/learnpython/comments/1czbfw/kinda_lostwhat_to_do_next/">projects</a> - as well they should be! Not only is making your own <a href="https://realpython.com/intermediate-python-project-ideas/#web">side project</a> the best way to get hands-on experience, but if you&rsquo;re looking to make the move from a hobby to a profession, then side projects are a great way to start building up a portfolio of work.</p>
<section class="section2" id="from-idea-to-mvp"><h2>From Idea to MVP<a class="headerlink" href="#from-idea-to-mvp" title="Permanent link"></a></h2>
<p>In this post, we&rsquo;ll work through the process of launching a (bare minimum) MVP, from the initial conception of the idea to a shareable prototype. By the end, you&rsquo;ll have created your own version of <a href="http://lyricize.herokuapp.com">Lyricize</a>, a small app that uses an artist or band&rsquo;s lyrics to generate &ldquo;new&rdquo; similar-sounding lyrics based on probabilities. Instead of presenting the typical &ldquo;here&rsquo;s how to replicate all this code&rdquo; tutorial, we&rsquo;ll go through the process step-by-step to show what&rsquo;s <em>actually</em> involved in the thought process and creation along the way.</p>
<blockquote>
<p>Note that this isn&rsquo;t necessarily about building the next killer startup; we&rsquo;re just looking to find a project that can be 1) a fun learning opportunity and 2) shareable with others.</p>
</blockquote>
<p><strong>Before we start take a look at the sample <a href="http://lyricize.herokuapp.com">app</a> to see what you&rsquo;ll be creating.</strong> Essentially, you can generate new lyrics based on a particular artist&rsquo;s lyrics using Markov chains. For example, try searching for &ldquo;Bob Dylan&rdquo; and change the number of lines to three. Pretty cool, right? I just executed the same search, which resulted in:</p>
<p><strong>Yonder stands your promise all and boats</strong> <br>
<strong>I&rsquo;m ready for the gorge</strong> <br>
<strong>I&rsquo;m a hook</strong></p>
<p>So deep. Anyway, let&rsquo;s begin &hellip;</p>
<hr />
<div><div class="rounded border border-light" style="display:block;position:relative;"><div style="display:block;width:100%;padding-top:12.5%;"></div><div class="rpad rounded border" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div></div><a class="small text-muted" href="/account/join/" rel="nofollow"><i aria-hidden="true" class="fa fa-info-circle"> </i> Remove ads</a></div></section><section class="section2" id="find-a-topic-of-interest"><h2>Find a topic of interest<a class="headerlink" href="#find-a-topic-of-interest" title="Permanent link"></a></h2>
<p>So, step 1: Find a topic you&rsquo;re interested in learning more about. The following app was inspired by an old <a href="http://www.cs.princeton.edu/courses/archive/fall13/cos126/assignments/markov.html">college assignment</a> (admittedly not the most common source of inspiration) that uses Markov chains to generate &ldquo;real-looking&rdquo; text given a body of sample text. Markov models crop up in <a href="http://en.wikipedia.org/wiki/Markov_chain#Applications">all sorts of scenarios</a>. (We&rsquo;ll dive into what a Markov model is shortly.) I found the idea of probability-based text generation particularly interesting; specifically, I wondered what would happen if you used song lyrics as sample text to generate &ldquo;new&rdquo; lyrics&hellip;</p>
<p>To the internet! A quick web search shows a few Markov-based lyric generator sites, but nothing quite like what I have in mind. Besides, plugging away at someone else&rsquo;s completed code isn&rsquo;t a very effective way to learn how Markov generators actually work; let&rsquo;s build our own.</p>
<p>So&hellip; how do Markov generators works? Basically, a Markov chain is generated from some text based on the frequency of certain patterns occurring. As an example, consider the following string as our sample text:</p>
<div class="highlight"><pre><span></span><code>bobby
</code></pre></div>
<p>We&rsquo;ll build the simplest possible Markov model out of this text, which is a Markov model of <em>order 0</em>, as a way to predict the likelihood of any particular letter occurring. This is a straight-forward frequency table:</p>
<div class="highlight"><pre><span></span><code>b: 3/5
o: 1/5
y: 1/5
</code></pre></div>
<p>However, this is a pretty bad language model; besides how frequently letters occur overall, we also want to look at how frequently a particular letter occurs <em>given the previous letter</em>. Since we&rsquo;re depending on one previous letter, this is a Markov model of order 1:</p>
<div class="highlight"><pre><span></span><code>given &quot;b&quot;:
  &quot;b&quot; is next: 1/3
  &quot;o&quot; is next: 1/3
  &quot;y&quot; is next: 1/3
given &quot;o&quot;:
  &quot;b&quot; is next: 1
given &quot;y&quot;:
  [terminates]: 1
</code></pre></div>
<p>From here, you could imagine Markov models of higher order; an order 2 model would start by measuring the frequency of each letter that occurs after the two-letter string &ldquo;bo&rdquo;, etc. By increasing the order, we get a model that starts looking more like real language; for instance, an order 5 Markov model that had been given lots of sample input including the word &ldquo;python&rdquo; would be very likely to follow the string &ldquo;pytho&rdquo; with an &ldquo;n&rdquo;, whereas a much lower order model might have come up with some creative words.</p>
</section><section class="section2" id="start-developing"><h2>Start Developing<a class="headerlink" href="#start-developing" title="Permanent link"></a></h2>
<p>How would we go about building a rough approximation of a Markov model? Essentially, the structure we&rsquo;ve outlined above with the higher-order models is a dictionary of dictionaries. You could imagine a <code>model</code> dictionary with various word fragments (i.e., &ldquo;bo&rdquo;) as keys. Each of these fragments would then point to a dictionary in turn, with those inner dictionaries holding the individual next letters (&ldquo;y&rdquo;) as keys with their respective frequencies as values.</p>
<p>Let&rsquo;s start by making a <code>generateModel()</code> method that takes in some sample text and a Markov model order, then returns this dictionary of dictionaries:</p>
<div class="highlight python"><pre><span></span><code><span class="k">def</span> <span class="nf">generateModel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="n">order</span><span class="p">):</span>
        <span class="n">fragment</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">order</span><span class="p">]</span>
        <span class="n">next_letter</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">order</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fragment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">next_letter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">next_letter</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">next_letter</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div>
<p>We looped through all the available text, going up until the last available full fragment + next letter so as not to run off the end of the string, adding our <code>fragment</code> dictionaries to the <code>model</code> with each <code>fragment</code> holding a dictionary of total <code>next_letter</code> frequencies.</p>
<p>Copy this function into a Python shell and try it out:</p>
<div class="highlight python repl"><span class="repl-toggle" title="Toggle REPL prompts and output">&gt;&gt;&gt;</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">generateModel</span><span class="p">(</span><span class="s2">&quot;bobby&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{&#39;b&#39;: {&#39;y&#39;: 1, &#39;b&#39;: 1, &#39;o&#39;: 1}, &#39;o&#39;: {&#39;b&#39;: 1}}</span>
</code></pre></div>
<p>That&rsquo;ll do! We have counts of frequencies instead of relative probabilities, but we can work with that; there&rsquo;s no reason we need to normalize each dictionary to add to probabilities of 100%.</p>
<p>Now let&rsquo;s use this <code>model</code> in a <code>getNextCharacter()</code> method that will, given a model and a fragment, decide on an appropriate next letter given the model&rsquo;s probabilities:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="k">def</span> <span class="nf">getNextCharacter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fragment</span><span class="p">):</span>
    <span class="n">letters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">times</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">letter</span><span class="p">]):</span>
            <span class="n">letters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">choice</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
</code></pre></div>
<p>It&rsquo;s not the most efficient setup, but it&rsquo;s simple to build and works for now. We simply built a list of letters, given their total frequencies of occurrence after the fragment, and chose randomly from that list.</p>
<p>All that remains is to use these two methods in a third method that will actually generate text of some specified length. To do this, we&rsquo;ll need to keep track of the current text fragment we&rsquo;re building while adding on new characters:</p>
<div class="highlight python"><pre><span></span><code><span class="k">def</span> <span class="nf">generateText</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">generateModel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

    <span class="n">currentFragment</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">order</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="n">order</span><span class="p">):</span>
        <span class="n">newCharacter</span> <span class="o">=</span> <span class="n">getNextCharacter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">currentFragment</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">newCharacter</span>
        <span class="n">currentFragment</span> <span class="o">=</span> <span class="n">currentFragment</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">newCharacter</span>
    <span class="nb">print</span> <span class="n">output</span>
</code></pre></div>
<p>Let&rsquo;s make this into a full runnable script that takes a Markov order and output text length as arguments:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">generateModel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="n">order</span><span class="p">):</span>
        <span class="n">fragment</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">order</span><span class="p">]</span>
        <span class="n">next_letter</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">order</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fragment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">next_letter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">next_letter</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">next_letter</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="k">def</span> <span class="nf">getNextCharacter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fragment</span><span class="p">):</span>
    <span class="n">letters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">times</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="n">fragment</span><span class="p">][</span><span class="n">letter</span><span class="p">]):</span>
            <span class="n">letters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">choice</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generateText</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">generateModel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
    <span class="n">currentFragment</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">order</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="n">order</span><span class="p">):</span>
        <span class="n">newCharacter</span> <span class="o">=</span> <span class="n">getNextCharacter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">currentFragment</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">newCharacter</span>
        <span class="n">currentFragment</span> <span class="o">=</span> <span class="n">currentFragment</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">newCharacter</span>
    <span class="nb">print</span> <span class="n">output</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;some sample text&quot;</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">generateText</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</code></pre></div>
<p>For now, we&rsquo;ll generate sample text via the very scientific method of throwing a string directly into the code based on some copied &amp; pasted Alanis Morisette lyrics.</p>
<div><div class="rounded border border-light" style="display:block;position:relative;"><div style="display:block;width:100%;padding-top:12.5%;"></div><div class="rpad rounded border" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div></div><a class="small text-muted" href="/account/join/" rel="nofollow"><i aria-hidden="true" class="fa fa-info-circle"> </i> Remove ads</a></div></section><section class="section2" id="test"><h2>Test<a class="headerlink" href="#test" title="Permanent link"></a></h2>
<p>Save the script and give it a whirl:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>python markov.py <span class="m">2</span> <span class="m">100</span>
<span class="go">I wounts</span>
<span class="go">You ho&#39;s humortel whime</span>
<span class="go"> mateend I wass</span>
<span class="go">How by Lover</span>
</code></pre></div>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>python markov.py <span class="m">4</span> <span class="m">100</span>
<span class="go">stress you to cosmic tears</span>
<span class="go">All they&#39;ve cracked you (honestly) at the filler in to like raise</span>
<span class="gp">$ </span>python markov.py <span class="m">6</span> <span class="m">100</span>
<span class="go">tress you place the wheel from me</span>
<span class="go">Please be philosophical</span>
<span class="go">Please be tapped into my house</span>
</code></pre></div>
<p>Well, that was just precious. The last two trials are decently representative of her lyrics (although the first sample of order 2 looks more like Björk). These results are encouraging enough for a quick code sketch, so let&rsquo;s turn this thing into a real project.</p>
</section><section class="section2" id="next-iteration"><h2>Next Iteration<a class="headerlink" href="#next-iteration" title="Permanent link"></a></h2>
<p>First hurdle: how are we going to automate getting lots of lyrics? One option would be to selectively scrape content from a lyrics site, but that sounds like a lot of effort for probably low-quality results, plus a potential legal gray area given the shadiness of most lyrics aggregators and the draconianism of the music industry. Instead, let&rsquo;s see if there are any open APIs. Heading over to search through <a href="http://www.programmableweb.com/search/lyrics">programmableweb.com</a>, we actually find <em>14</em> different lyrics APIs listed. These listings aren&rsquo;t always the most up-to-date, though, so let&rsquo;s search through by the most recently listed.</p>
<p><a href="http://www.lyricsnmusic.com/api">LYRICSnMUSIC</a> offers a free, <a href="https://realpython.com/api-integration-in-python/">RESTful API</a> using <a href="https://realpython.com/python-json/">JSON</a> to return up to 150 characters of song lyrics. This sounds perfect for our use-case, especially given the repetition of most songs; there&rsquo;s no need to gather full lyrics when just a sample will do. Go grab a <a href="http://www.lyricsnmusic.com/api_keys/new">new key</a> so that you can access their API.</p>
<p>Let&rsquo;s try their API out before we settle on this source for good. Based on their documentation, we can make a sample request like so:</p>
<div class="highlight"><pre><span></span><code>http://api.lyricsnmusic.com/songs?api_key=[YOUR_API_KEY_HERE]&amp;artist=coldplay
</code></pre></div>
<p>The JSON results it spits back in a browser are a bit hard to read; through them in a <a href="http://jsonformatter.curiousconcept.com/">formatter</a> to take a better look. It looks like we&rsquo;re successfully getting back a list of dictionaries based on Coldplay songs:</p>
<div class="highlight json"><pre><span></span><code><span class="p">[</span>
  <span class="p">{</span>
     <span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Don&#39;t Panic&quot;</span><span class="p">,</span>
     <span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.lyricsnmusic.com/coldplay/don-t-panic-lyrics/4294612&quot;</span><span class="p">,</span>
     <span class="nt">&quot;snippet&quot;</span><span class="p">:</span><span class="s2">&quot;Bones sinking like stones \r\nAll that we&#39;ve fought for \r\nHomes, places we&#39;ve grown \r\nAll of us are done for \r\n\r\nWe live in a beautiful world \r\nYeah we ...&quot;</span><span class="p">,</span>
     <span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span>
     <span class="nt">&quot;viewable&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
     <span class="nt">&quot;instrumental&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
     <span class="nt">&quot;artist&quot;</span><span class="p">:{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Coldplay&quot;</span><span class="p">,</span>
        <span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.lyricsnmusic.com/coldplay&quot;</span>
     <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
     <span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Shiver&quot;</span><span class="p">,</span>
     <span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.lyricsnmusic.com/coldplay/shiver-lyrics/4294613&quot;</span><span class="p">,</span>
     <span class="nt">&quot;snippet&quot;</span><span class="p">:</span><span class="s2">&quot;So I look in your direction\r\nBut you pay me no attention, do you\r\nI know you don&#39;t listen to me\r\n&#39;Cause you say you see straight through me, don&#39;t you...&quot;</span><span class="p">,</span>
     <span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span>
     <span class="nt">&quot;viewable&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
     <span class="nt">&quot;instrumental&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
     <span class="nt">&quot;artist&quot;</span><span class="p">:{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Coldplay&quot;</span><span class="p">,</span>
        <span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.lyricsnmusic.com/coldplay&quot;</span>
     <span class="p">}</span>
  <span class="p">},</span>
  <span class="err">...</span>
<span class="p">]</span>
</code></pre></div>
<p>There&rsquo;s no way to limit the response, but we&rsquo;re only interested in each &ldquo;snippet&rdquo; provided, which looks just fine for this project.</p>
<p>Our preliminary experiments with Markov generators were educational, but our current model isn&rsquo;t the best suited to the task of generating lyrics. For one thing, we should probably use individual words as our tokens rather than taking things character by character; it&rsquo;s fun trying to mock language itself, but for generating fake lyrics, we&rsquo;ll want to stick to real English. This sounds trickier, though, and we&rsquo;ve come a long way to understanding how Markov chains operate, which was the initial goal with that exercise. At this point, we reach a crossroads: reinvent the metaphorical wheel for the sake of more learning (it could be great coding practice), or see what else others have already created.</p>
<p>I chose the lazy way out and headed back to search the innerwebs. A kind soul on GitHub has already <a href="https://github.com/MaxWagner/PyMarkovChain">implemented</a> a basic single-word-based Markov chain and even uploaded it to <a href="https://pypi.python.org/pypi/PyMarkovChain/">PyPI</a>. Taking a quick stroll through the <a href="https://github.com/ketaro/markov-cranberries/blob/master/markov.py">code</a>, it appears that this model is only of order 0. This probably would have been quick enough to build on our own, while a higher-order model might be significantly more work. For now, let&rsquo;s go with someone else&rsquo;s pre-packaged wheel; at least an order 0 model won&rsquo;t end up sounding like Björk if we&rsquo;re using whole words.</p>
<p>Since we want to easily share our creation with friends and family, it makes sense to turn it into a web application. Now, to choose a web framework. Personally, I&rsquo;m by far the most familiar with Django, but that seems like overkill here; after all, we won&rsquo;t even need a database of our own. Let&rsquo;s try out Flask.</p>
</section><section class="section2" id="add-flask"><h2>Add Flask<a class="headerlink" href="#add-flask" title="Permanent link"></a></h2>
<p>Per the usual routine, <a href="https://realpython.com/python-virtual-environments-a-primer/">fire up a virtual environment</a> - if you haven&rsquo;t already! If this isn&rsquo;t a familiar process, take a look through some of our <a href="https://realpython.com/python-web-applications-with-flask-part-i/#toc_5">previous posts</a> to learn how to get set up.</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>mkdir lyricize
<span class="gp">$ </span><span class="nb">cd</span> lyricize
<span class="gp">$ </span>virtualenv --no-site-packages venv
<span class="gp">$ </span><span class="nb">source</span> venv/bin/activate
</code></pre></div>
<p>Also as per usual, install the necessary requirements and throw them in a requirements.txt file:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>pip install PyMarkovChain flask requests
<span class="gp">$ </span>pip freeze &gt; requirements.txt
</code></pre></div>
<p>We&rsquo;ve added in the <a href="http://docs.python-requests.org/en/latest/">requests</a> library as well so that we can make web requests to the lyrics API.</p>
<p>Now, to make the app. For the sake of simplicity, let&rsquo;s split it up into two pages: the main page will present a basic form to the user for choosing an artist name and a number of lines of lyrics to generate, while a second &ldquo;lyrics&rdquo; page will present the results. Let&rsquo;s start with a barebones Flask application named <strong>app.py</strong> that uses an <strong>index.html</strong> template:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><em>All</em> this app will do so far is load the contents of an index.html template. Let&rsquo;s make it a basic form:</p>
<div class="highlight html"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;lyrics&quot;</span><span class="p">&gt;</span>
    Artist or band name: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;artist&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
    Number of lines:
    <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;lines&quot;</span><span class="p">&gt;</span>
      {% for n in range(1,11) %}
        <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{n}}&quot;</span><span class="p">&gt;</span>{{n}}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
      {% endfor %}
    <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Lyricize&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>Save this index.html in a separate folder named <em>templates</em> so that Flask can find it. Here we&rsquo;re using Flask&rsquo;s Jinja2 templating to create a &ldquo;selection&rdquo; dropdown based on a loop covering the numbers 1 through 10. Before we add anything else, fire up this page to make sure we&rsquo;re set up correctly:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>python app.py
<span class="go">* Running on http://127.0.0.1:5000/</span>
</code></pre></div>
<p>You should now be able to visit http://127.0.0.1:5000/ in a browser and see the lovely form.</p>
<p>Now let&rsquo;s decide what we want to show on the results page, so that we know what we&rsquo;ll need to pass to it:</p>
<div class="highlight html"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">align</span><span class="o">=</span><span class="s">&quot;center&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding-top:20px;&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>
   {% for line in result %}
     {{ line }}<span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   {% endfor %}
   <span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>{{ artist }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;index&#39;) }}&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Do it again!&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>Here we looped through a <strong>result</strong> array, line by line, displaying each line separately. Below that, we show the <strong>artist</strong> selected and link back to the homepage. Save this as <em>lyrics.html</em> in your /templates directory.</p>
<p>We also need to update the form action of index.html to point to this results page:</p>
<div class="highlight html"><pre><span></span><code><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;lyrics&#39;) }}&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;lyrics&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<p>Now to write a route for the resulting lyrics page:</p>
<div class="highlight python"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/lyrics&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">lyrics</span><span class="p">():</span>
    <span class="n">artist</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;artist&#39;</span><span class="p">]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;lines&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;lyrics.html&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">],</span> <span class="n">artist</span><span class="o">=</span><span class="n">artist</span><span class="p">)</span>
</code></pre></div>
<p>This page takes a POST request from the form, parsing out the provided <strong>artist</strong> and number of <strong>lines</strong> - we aren&rsquo;t generating any lyrics yet, just giving the template a dummy list of results. We&rsquo;ll also need to add the necessary Flask functionality - <code>url_for</code> and <code>redirect</code> - that we&rsquo;ve relied on:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">redirect</span>
</code></pre></div>
<p>Test it out to make sure nothing&rsquo;s broken yet:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>python app.py
</code></pre></div>
<p>Great, now for the real meat of the project. Within lyrics(), let&rsquo;s get a response back from LYRICSnMUSIC based on our passed-in artist parameter:</p>
<div class="highlight python"><pre><span></span><code><span class="c1"># Get a response of sample lyrics from the provided artist</span>
<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;http://api.lyricsnmusic.com/songs&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
    <span class="s1">&#39;artist&#39;</span><span class="p">:</span> <span class="n">artist</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="n">lyric_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
<p>Using requests, we fetch a specific URL that includes a dictionary of parameters: the provided artist name, and our API key. This private API key should <em>not</em> appear in your code; after all, you&rsquo;ll want to share this code with others. Instead, let&rsquo;s make a separate file to hold this value as a variable:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;API_KEY=[youractualapikeygoeshere]&quot;</span> &gt; .env
</code></pre></div>
<p>We&rsquo;ve created a special &ldquo;environment&rdquo; file that Flask can now read in if we just add the following to the top of our app:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;API_KEY&#39;</span><span class="p">)</span>
</code></pre></div>
<p>And finally, let&rsquo;s add in the Markov chain functionality. Now that we&rsquo;re using someone else&rsquo;s package, this ends up being fairly trivial. First, add the import at the top:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">pymarkovchain</span> <span class="kn">import</span> <span class="n">MarkovChain</span>
</code></pre></div>
<p>And then, after we&rsquo;ve received a <strong>lyrics</strong> response from the API, we simply create a MarkovChain, load in the lyrics data, and generate a list of sentences:</p>
<div class="highlight python"><pre><span></span><code><span class="n">mc</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">()</span>
<span class="n">mc</span><span class="o">.</span><span class="n">generateDatabase</span><span class="p">(</span><span class="n">lyrics</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">generateString</span><span class="p">())</span>
</code></pre></div>
<p>In total, then, app.py should now look something like this:</p>
<div class="highlight python"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">pymarkovchain</span> <span class="kn">import</span> <span class="n">MarkovChain</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;API_KEY&#39;</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/lyrics&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">lyrics</span><span class="p">():</span>
    <span class="n">artist</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;artist&#39;</span><span class="p">]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;lines&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>

    <span class="c1"># Get a response of sample lyrics from the artist</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;http://api.lyricsnmusic.com/songs&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;api_key&#39;</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s1">&#39;artist&#39;</span><span class="p">:</span> <span class="n">artist</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
    <span class="n">lyric_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="c1"># Parse results into a long string of lyrics</span>
    <span class="n">lyrics</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">lyric_dict</span> <span class="ow">in</span> <span class="n">lyric_list</span><span class="p">:</span>
        <span class="n">lyrics</span> <span class="o">+=</span> <span class="n">lyric_dict</span><span class="p">[</span><span class="s1">&#39;snippet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>

    <span class="c1"># Generate a Markov model</span>
    <span class="n">mc</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">()</span>
    <span class="n">mc</span><span class="o">.</span><span class="n">generateDatabase</span><span class="p">(</span><span class="n">lyrics</span><span class="p">)</span>

    <span class="c1"># Add lines of lyrics</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">generateString</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;lyrics.html&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="n">artist</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p>Try it out! Everything should be working locally. Now, to share it with the world&hellip;</p>
<div><div class="rounded border border-light" style="display:block;position:relative;"><div style="display:block;width:100%;padding-top:12.5%;"></div><div class="rpad rounded border" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div></div><a class="small text-muted" href="/account/join/" rel="nofollow"><i aria-hidden="true" class="fa fa-info-circle"> </i> Remove ads</a></div></section><section class="section2" id="deploy-to-heroku"><h2>Deploy to Heroku<a class="headerlink" href="#deploy-to-heroku" title="Permanent link"></a></h2>
<p>Let&rsquo;s host on Heroku, since (for these minimal requirements) we can do that for free. To do so, we&rsquo;ll need to make a few minor tweaks to the code. First, add a <a href="https://devcenter.heroku.com/articles/procfile">Procfile</a> that will tell Heroku how to serve the app:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;web: python app.py&quot;</span> &gt; Procfile
</code></pre></div>
<p>Next, since Heroku specifies a random port on which to run the application, you&rsquo;ll need to pass a port number in at the top:</p>
<div class="highlight python"><pre><span></span><code><span class="n">PORT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PORT&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">))</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div>
<p>And when the app is run, make sure to pass this port in</p>
<div class="highlight python"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">)</span>
</code></pre></div>
<p>We also had to specify the host of &lsquo;0.0.0.0&rsquo; because Flask by default runs privately on the local computer, while we want the app to run on Heroku on a publicly available IP.</p>
<p>Finally, remove <code>app.debug=True</code> from your code so that users don&rsquo;t get to see your full stacktrace errors if something goes wrong.</p>
<p>Initialize a git repository (if you haven&rsquo;t already), create a new Heroku app, and push your code to it!</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>git init
<span class="gp">$ </span>git add .
<span class="gp">$ </span>git commit -m <span class="s2">&quot;First commit&quot;</span>
<span class="gp">$ </span>heroku create
<span class="gp">$ </span>git push heroku master
</code></pre></div>
<p>See the <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Heroku docs</a> for a more thorough rundown of this deployment process. Be sure to add your API_KEY variable on Heroku:</p>
<div class="highlight sh"><pre><span></span><code><span class="gp">$ </span>heroku config:set <span class="nv">API_KEY</span><span class="o">=[</span>youractualapikeygoeshere<span class="o">]</span>
</code></pre></div>
<p>And we&rsquo;re all set! Time to share your creation with the world - or keep hacking at it :)</p>
</section><section class="section2" id="conclusion-next-steps"><h2>Conclusion &amp; Next Steps<a class="headerlink" href="#conclusion-next-steps" title="Permanent link"></a></h2>
<p>If you liked this content, you might be interested in our <a href="https://realpython.com">current courses</a> for learning web development or our newest <a href="http://kck.st/1b0tz6I">Kickstarter</a> that covers more advanced techniques. Or - just play around with the app <a href="http://lyricize.herokuapp.com">here</a>.</p>
<p><strong>Possible next steps:</strong></p>
<ul>
<li>This HTML looks like it was written in the early 90s; use <a href="https://github.com/mbr/flask-bootstrap">Bootstrap</a> or just some basic CSS for styling</li>
<li>Add some comments to the code before you forget what it does! (This is left as an exercise for the reader :o)</li>
<li>Abstract the code in the lyrics route to be individual methods (ie, a method to return responses from the lyrics API and another separate method for generating the Markov model); this will make the code more easily maintainable and testable as it grows in size and complexity</li>
<li>Create a Markov generator that is able to use higher orders</li>
<li>Use <a href="https://flask-wtf.readthedocs.org/en/latest/">Flask-WTF</a> to improve the forms and form validation</li>
<li>Speaking of which: make it more secure! Right now, someone could potentially send unreasonable POST requests, inject their own code into the page or DoS the site with many quickly repeated requests; add some solid input validation and basic rate limiting</li>
<li>Add better error handling; what if an API call takes too long or fails for some reason?</li>
<li>Throw the results into a <a href="http://tts-api.com/">text-to-speech</a> engine, learn to vary the pitch patterns using another Markov model, and set to a beat; soon you&rsquo;ll be at the top of the charts!</li>
</ul>
</section>
<div class="text-center my-3">
<div class="jsCompletionStatusWidget btn-group mb-0">
<button title="Click to mark as completed" class="jsBtnCompletion btn btn-secondary border-right " style="border-top-right-radius: 0; border-bottom-right-radius: 0;" disabled>Mark as Completed</button>
<button title="Add bookmark" class="jsBtnBookmark btn btn-secondary border-left" disabled><i class="fa fa-fw fa-bookmark-o"></i></button>
</div>
</div>
</div>
<div class="card mt-4 mb-4 bg-secondary">
<p class="card-header h3 text-center bg-light">🐍 Python Tricks 💌</p>
<div class="card-body">
<div class="container">
<div class="row">
<div class="col-xs-12 col-sm-7">
<p>Get a short &amp; sweet <strong>Python Trick</strong> delivered to your inbox every couple of days. No spam ever. Unsubscribe any time. Curated by the Real Python team.</p>
</div>
<div class="col-xs-12 col-sm-5">
<img class="img-fluid rounded mb-3" src="https://cdn.realpython.com/static/pytrick-dict-merge.4201a0125a5e.png" width="738" height="490" alt="Python Tricks Dictionary Merge">
</div>
</div>
<div class="row mb-3">
<form class="col-12" action="/optins/process/" method="post">
<input type="hidden" name="csrfmiddlewaretoken" value="AHy4XxmFttVQ2gIQ2aeCm9y3JGnk1YNyGMdhy6yDOYQ0c9nybWGMMexZZBseewhn">
<input type="hidden" name="slug" value="static-python-tricks-footer">
<div class="form-group">
<input name="email" type="email" class="form-control form-control-lg" placeholder="Email Address" required>
</div>
<button name="submit" type="submit" class="btn btn-primary btn-lg btn-block">Send Me Python Tricks »</button>
</form>
</div>
</div>
</div>
</div>
<div class="bg-light rounded py-4 my-4 shadow shadow-sm mx-n2">
<div class="col-12 text-center d-block d-md-none">
<p class="h2 mb-3">Master <u><span class="marker-highlight">Real-World Python Skills</mark></u> With Unlimited Access to Real&nbsp;Python</p>
<p class="mb-1"><img class="w-75" src="https://cdn.realpython.com/static/videos/lesson-locked.f5105cfd26db.svg" width="510" height="260"></p>
<p class="mx-auto w-75 mb-3 small"><strong>Join us and get access to hundreds of tutorials, hands-on video courses, and a community of expert&nbsp;Pythonistas:</strong></p>
<p class="mb-0"><a href="/account/join/?utm_source=rp_article_footer&utm_content=lyricize-a-flask-app-to-create-lyrics-using-markov-chains" class="btn btn-primary btn-sm px-4 mb-0">Level Up Your Python Skills »</a>
</div>
<div class="col-12 text-center d-none d-md-block">
<p class="h2 mb-2">Master <u><span class="marker-highlight">Real-World Python Skills</span></u><br>With Unlimited Access to Real&nbsp;Python</p>
<p class="mb-2"><img class="w-50 mb-2" src="https://cdn.realpython.com/static/videos/lesson-locked.f5105cfd26db.svg" width="510" height="260"></p>
<p class="mx-auto w-50 mb-3"><strong>Join us and get access to hundreds of tutorials, hands-on video courses, and a community of expert Pythonistas:</strong></p>
<p><a href="/account/join/?utm_source=rp_article_footer&utm_content=lyricize-a-flask-app-to-create-lyrics-using-markov-chains" class="btn btn-primary btn-lg px-4">Level Up Your Python Skills »</a>
</div>
</div>
<div class="card mt-4" id="reader-comments">
<p class="card-header h3">What Do You Think?</p>
<div class="text-center mt-3 mb-0 p-0">
<span>
<a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet/?text=Check out this %23Python tutorial: Lyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains by @realpython&url=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-twitter text-light mb-1"><i class="mr-1 fa fa-twitter text-light"></i>Tweet</a>
<a target="_blank" rel="nofollow" href="https://facebook.com/sharer/sharer.php?u=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-facebook text-light mb-1"><i class="mr-1 fa fa-facebook text-light"></i>Share</a>
<a target="_blank" rel="nofollow" href="mailto:?subject=Python article for you&body=Check out this Python tutorial:%0A%0ALyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains%0A%0Ahttps%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="badge badge-red text-light mb-1"><i class="mr-1 fa fa-envelope text-light"></i>Email</a>
</span>
</div>
<div class="card-body">
<div class="alert alert-dark">
<p class="mb-0"><strong>Real Python Comment Policy:</strong> The most useful comments are those written with the goal of learning from or helping out other readers—after reading the whole article and all the earlier comments. Complaints and insults generally won’t make the cut here.</p>
</div>
<p>What’s your #1 takeaway or favorite thing you learned? How are you going to put your newfound skills to use? Leave a comment below and let us know.</p>
<div class="mb-4" id="disqus_thread">
</div>
</div>
</div>
<div class="card mt-4 mb-4">
<p class="card-header h3">Keep Learning</p>
<div class="card-body">
<p class="mb-0">Related Tutorial Categories:
<a href="/tutorials/flask/" class="badge badge-light text-muted">flask</a>
<a href="/tutorials/projects/" class="badge badge-light text-muted">projects</a>
<a href="/tutorials/web-dev/" class="badge badge-light text-muted">web-dev</a>
</p>
</div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" id="rprw">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header border-0 mt-3">
<div class="col-12 modal-title text-center">
<h2 class="my-0 mx-5">Keep reading Real&nbsp;Python by creating a free account or signing&nbsp;in:</h2>
</div>
</div>
<div class="modal-body bg-light">
<div class="col-12 text-center">
<p class="mb-2 mt-3"><a href="/account/signup/?intent=continue_reading&utm_source=rp&utm_medium=web&utm_campaign=rwn&utm_content=v1&next=%2Flyricize-a-flask-app-to-create-lyrics-using-markov-chains%2F"><img class="w-50 mb-2" src="https://cdn.realpython.com/static/videos/lesson-locked.f5105cfd26db.svg" width="510" height="260" alt="Keep reading"></a></p>
<p><a href="/account/signup/?intent=continue_reading&utm_source=rp&utm_medium=web&utm_campaign=rwn&utm_content=v1&next=%2Flyricize-a-flask-app-to-create-lyrics-using-markov-chains%2F" class="btn btn-primary btn-lg px-5"></i>Continue »</a></a>
</div>
</div>
<div class="modal-footer border-0">
<p class="text-center text-muted mt-2 mb-1">Already have an account? <a href="/account/login/?next=/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/">Sign-In</a></p>
</div>
</div>
</div>
</div>
<script src="https://cdn.realpython.com/static/frontend/reader/rw.38bf29157dfe.js" async></script>
</div>
<aside class="col-md-7 col-lg-4">
<div class="card mb-3 bg-secondary">
<form class="card-body" action="/optins/process/" method="post">
<div class="form-group">
<p class="h5 text-muted text-center">— FREE Email Series —</p>
<p class="h3 text-center">🐍 Python Tricks 💌</p>
<p><img class="img-fluid rounded" src="https://cdn.realpython.com/static/pytrick-dict-merge.4201a0125a5e.png" width="738" height="490" alt="Python Tricks Dictionary Merge"></p>
</div>
<div class="form-group">
<input type="hidden" name="csrfmiddlewaretoken" value="AHy4XxmFttVQ2gIQ2aeCm9y3JGnk1YNyGMdhy6yDOYQ0c9nybWGMMexZZBseewhn">
<input type="hidden" name="slug" value="static-python-tricks-sidebar">
<input type="email" class="form-control form-control-md" name="email" placeholder="Email&hellip;" required>
</div>
<button type="submit" name="submit" class="btn btn-primary btn-md btn-block">Get Python Tricks »</button>
<p class="mb-0 mt-2 text-muted text-center">🔒 No spam. Unsubscribe any time.</p>
</form>
</div>
<div class="sidebar-module sidebar-module-inset border">
<p class="h4"><a class="link-unstyled" href="/tutorials/all/">All Tutorial Topics</a></p>
<a href="/tutorials/advanced/" class="badge badge-light text-muted">advanced</a>
<a href="/tutorials/api/" class="badge badge-light text-muted">api</a>
<a href="/tutorials/basics/" class="badge badge-light text-muted">basics</a>
<a href="/tutorials/best-practices/" class="badge badge-light text-muted">best-practices</a>
<a href="/tutorials/community/" class="badge badge-light text-muted">community</a>
<a href="/tutorials/databases/" class="badge badge-light text-muted">databases</a>
<a href="/tutorials/data-science/" class="badge badge-light text-muted">data-science</a>
<a href="/tutorials/devops/" class="badge badge-light text-muted">devops</a>
<a href="/tutorials/django/" class="badge badge-light text-muted">django</a>
<a href="/tutorials/docker/" class="badge badge-light text-muted">docker</a>
<a href="/tutorials/flask/" class="badge badge-light text-muted">flask</a>
<a href="/tutorials/front-end/" class="badge badge-light text-muted">front-end</a>
<a href="/tutorials/gamedev/" class="badge badge-light text-muted">gamedev</a>
<a href="/tutorials/gui/" class="badge badge-light text-muted">gui</a>
<a href="/tutorials/intermediate/" class="badge badge-light text-muted">intermediate</a>
<a href="/tutorials/machine-learning/" class="badge badge-light text-muted">machine-learning</a>
<a href="/tutorials/projects/" class="badge badge-light text-muted">projects</a>
<a href="/tutorials/python/" class="badge badge-light text-muted">python</a>
<a href="/tutorials/testing/" class="badge badge-light text-muted">testing</a>
<a href="/tutorials/tools/" class="badge badge-light text-muted">tools</a>
<a href="/tutorials/web-dev/" class="badge badge-light text-muted">web-dev</a>
<a href="/tutorials/web-scraping/" class="badge badge-light text-muted">web-scraping</a>
</div>
<div class="sidebar-module sidebar-module-inset p-0" style="overflow:hidden;">
<div style="display:block;position:relative;">
<div style="display:block;width:100%;padding-top:100%;"></div>
<div class="rpad" data-unit="1x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
</div>
</div>
<div class="sidebar-sticky ">
<div class="bg-light sidebar-module sidebar-module-inset" id="sidebar-toc">
<p class="h4 text-muted"><a class="link-unstyled" href="#toc">Table of Contents</a></p>
<div class="toc">
<ul>
<li><a href="#from-idea-to-mvp">From Idea to MVP</a></li>
<li><a href="#find-a-topic-of-interest">Find a topic of interest</a></li>
<li><a href="#start-developing">Start Developing</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#next-iteration">Next Iteration</a></li>
<li><a href="#add-flask">Add Flask</a></li>
<li><a href="#deploy-to-heroku">Deploy to Heroku</a></li>
<li><a href="#conclusion-next-steps">Conclusion &amp; Next Steps</a></li>
</ul>
</div>
</div>
<div class="sidebar-module sidebar-module-inset text-center my-3 py-0">
<div class="jsCompletionStatusWidget btn-group mb-0">
<button title="Click to mark as completed" class="jsBtnCompletion btn btn-secondary border-right " style="border-top-right-radius: 0; border-bottom-right-radius: 0;" disabled>Mark as Completed</button>
<button title="Add bookmark" class="jsBtnBookmark btn btn-secondary border-left" disabled><i class="fa fa-fw fa-bookmark-o"></i></button>
</div>
</div>
<div class="sidebar-module sidebar-module-inset text-center my-3 py-0">
<span>
<a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet/?text=Check out this %23Python tutorial: Lyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains by @realpython&url=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-twitter text-light mb-1"><i class="mr-1 fa fa-twitter text-light"></i>Tweet</a>
<a target="_blank" rel="nofollow" href="https://facebook.com/sharer/sharer.php?u=https%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="mr-1 badge badge-facebook text-light mb-1"><i class="mr-1 fa fa-facebook text-light"></i>Share</a>
<a target="_blank" rel="nofollow" href="mailto:?subject=Python article for you&body=Check out this Python tutorial:%0A%0ALyricize%3A%20A%20Flask%20app%20to%20create%20lyrics%20using%20Markov%20chains%0A%0Ahttps%3A//realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/" class="badge badge-red text-light mb-1"><i class="mr-1 fa fa-envelope text-light"></i>Email</a>
</span>
</div>
<div class="sidebar-module sidebar-module-inset p-0" style="overflow:hidden;">
<div style="display:block;position:relative;">
<div style="display:block;width:100%;padding-top:25%;"></div>
<div class="rpad" data-unit="4x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
</div>
</div>
</div>
</aside>
</div>
</div>
<footer class="footer">
<div class="container">
<div class="w-75 mx-auto mt-4 mb-0">
<div style="display:block;position:relative;">
<div style="display:block;width:100%;padding-top:12.5%;"></div>
<div class="rpad rounded border" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
</div>
<a class="small text-muted" href="/account/join/" rel="nofollow"> <i class="fa fa-info-circle" aria-hidden="true"> </i> Remove ads</a>
</div>
<p class="text-center text-muted w-75 mx-auto">© 2012–2021 Real Python&nbsp;⋅ <a href="/newsletter/">Newsletter</a>&nbsp;⋅ <a href="/podcasts/rpp/">Podcast</a>&nbsp;⋅ <a href="https://www.youtube.com/realpython">YouTube</a>&nbsp;⋅ <a href="https://twitter.com/realpython">Twitter</a>&nbsp;⋅ <a href="https://facebook.com/LearnRealPython">Facebook</a>&nbsp;⋅ <a href="https://www.instagram.com/realpython/">Instagram</a>&nbsp;⋅ <a href="/">Python&nbsp;Tutorials</a>&nbsp;⋅ <a href="/search">Search</a>&nbsp;⋅ <a href="/privacy-policy/">Privacy Policy</a>&nbsp;⋅ <a href="/energy-policy/" class="text-success active">Energy Policy</a>&nbsp;⋅ <a href="/sponsorships/">Advertise</a>&nbsp;⋅ <a href="/contact/">Contact</a><br>❤️ Happy Pythoning!</p>
</div>
</footer>
<script>
      (function(document, history, location) {
        var HISTORY_SUPPORT = !!(history && history.pushState);

        var anchorScrolls = {
          ANCHOR_REGEX: /^#[^ ]+$/,
          OFFSET_HEIGHT_PX: 120,

          /**
           * Establish events, and fix initial scroll position if a hash is provided.
           */
          init: function() {
            this.scrollToCurrent();
            window.addEventListener('hashchange', this.scrollToCurrent.bind(this));
            document.body.addEventListener('click', this.delegateAnchors.bind(this));
          },

          /**
           * Return the offset amount to deduct from the normal scroll position.
           * Modify as appropriate to allow for dynamic calculations
           */
          getFixedOffset: function() {
            return this.OFFSET_HEIGHT_PX;
          },

          /**
           * If the provided href is an anchor which resolves to an element on the
           * page, scroll to it.
           * @param  {String} href
           * @return {Boolean} - Was the href an anchor.
           */
          scrollIfAnchor: function(href, pushToHistory) {
            var match, rect, anchorOffset;

            if(!this.ANCHOR_REGEX.test(href)) {
              return false;
            }

            match = document.getElementById(href.slice(1));

            if(match) {
              rect = match.getBoundingClientRect();
              anchorOffset = window.pageYOffset + rect.top - this.getFixedOffset();
              window.scrollTo(window.pageXOffset, anchorOffset);

              // Add the state to history as-per normal anchor links
              if(HISTORY_SUPPORT && pushToHistory) {
                history.pushState({}, document.title, location.pathname + href);
              }
            }

            return !!match;
          },

          /**
           * Attempt to scroll to the current location's hash.
           */
          scrollToCurrent: function() {
            this.scrollIfAnchor(window.location.hash);
          },

          /**
           * If the click event's target was an anchor, fix the scroll position.
           */
          delegateAnchors: function(e) {
            var elem = e.target;

            if(
              elem.nodeName === 'A' &&
              this.scrollIfAnchor(elem.getAttribute('href'), true)
            ) {
              e.preventDefault();
            }
          }
        };

        window.addEventListener(
          'DOMContentLoaded', anchorScrolls.init.bind(anchorScrolls)
        );
      })(window.document, window.history, window.location);
    </script>
<script src="https://cdn.realpython.com/static/jquery.min.8fb8fee4fcc3.js"></script>
<script src="https://cdn.realpython.com/static/popper.min.1022eaf388cc.js"></script>
<script src="https://cdn.realpython.com/static/bootstrap.min.f0c2bcf5ef0c.js"></script>
<script>
    (function() {
      document.querySelectorAll(".js-search-form-submit").forEach(function(el) {
        el.addEventListener("click", function(e) {
          e.preventDefault();
          e.currentTarget.parentElement.submit();
        })
      });
    })();
    </script>
<script src="https://cdn.realpython.com/static/frontend/reader/repl-toggle.de6c7bf44788.js" async></script>
<script src="https://cdn.realpython.com/static/frontend/reader/lightbox.49cdac39212e.js" async></script>
<script>window.rp_prop_id = '58946116052';</script>
<script src="https://srv.realpython.net/tag.js" async></script>
<script src="https://cdn.realpython.com/static/frontend/reader/toc-refresh.76a102c7d921.js" async></script>
<script id="js-context" type="application/json">{"is_completed": false, "is_bookmarked": false, "api_article_bookmark_url": "/api/v1/articles/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/bookmark/", "api_article_completion_status_url": "/api/v1/articles/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/completion_status/"}</script>
<script src="https://cdn.realpython.com/static/frontend/reader/completion-status.352d07abd84a.js" async></script>
<script id="dsq-count-scr" src="https://realpython.disqus.com/count.js" async></script>
<script>
      var disqus_config = function () {
        this.page.url = 'https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/';
        this.page.identifier = 'https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/';
        this.callbacks.onReady = [function() {
          if (window.onDisqusReady) {
            window.onDisqusReady();
          }
        }];
      };
      var disqus_script_url = 'https://realpython.disqus.com/embed.js';
    </script>
<script src="https://cdn.realpython.com/static/frontend/reader/lazy-disqus.07ee9079f4a3.js" defer></script>
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Lyricize: A Flask app to create lyrics using Markov chains",
    
    "image": {
      "@type": "ImageObject",
      "url": "https://cdn.realpython.com/static/real-python-placeholder-3.5082db8a1a4d.jpg",
      "width": 1920,
      "height": 1080
    },
    
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://realpython.com/lyricize-a-flask-app-to-create-lyrics-using-markov-chains/"
    },
    "datePublished": "2014-01-07T00:20:19+00:00",
    "dateModified": "2020-10-24T00:05:36.495596+00:00",
     "publisher": {
      "@type": "Organization",
      "name": "Real Python",
      "logo": {
        "@type": "ImageObject",
        "url": "https://cdn.realpython.com/static/real-python-logo-square-tiny.b2452b6d3823.png",
        "width": 60,
        "height": 60
      }
    },
    "author": {
      "@type": "Organization",
      "name": "Real Python",
      "url": "https://realpython.com",
      "logo": "https://cdn.realpython.com/static/real-python-logo-square.146e987bf77c.png"
    },
    "description": "In this post, we\u0027ll work through the process of launching a MVP, from the initial conception of the idea to a shareable prototype utilizing Flask. We\u0027ll create an app to generate lyrics using Markov chains."
  }
  </script>
<script>
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '6214500';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/6214500.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<script type="text/javascript">(function(){window['__CF$cv$params']={r:'694a456c5ff20f52',m:'WYXIgUYch0GrYd8hY6mAD10crcrSbp3w_0lKeHPYFmU-1632636018-0-Ad9cuYQuSL8Sjx+GKDDWyzMkLLI9FpbOpHRiQ2mtKLSubR+Xr8xGey+b0gEUkJlKrHk1ZSwpxKiupuVM/YXtcPvvtt4YCLI/wvJd09L0kZbYzKaB0SAXzEcEWJs7Yo51N9UwCt2BFsNCyvUDZ2FT0guQJFk8OUiPvbriw7Tbvb3VLKldUbiprMGOrUvgAtXi9A==',s:[0x1430063384,0x345e65f4da],}})();</script></body>
</html>
